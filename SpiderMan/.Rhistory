time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시',
time>='23:00'&time<'24:00', '23시'))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시',
time>='23:00'&time<'24:00', '23시'))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시',
time>='23:00'&time<'24:00', '23시')))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시',
time>='23:00'&time<'24:00', '23시')))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시',
time>='23:00'&time<'24:00', '23시'))))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시',
time>='23:00'&time<'24:00', '23시'))))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시',
time>='23:00'&time<'24:00', '23시')))))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시',
time>='23:00'&time<'24:00', '23시'))))))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시',
time>='23:00'&time<'24:00', '23시')))))))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시',
time>='23:00'&time<'24:00', '23시')))))))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시',
time>='23:00'&time<'24:00', '23시')))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시',
time>='23:00'&time<'24:00', '23시'))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시','23시'))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시','23시')))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시','23시'))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시','23시')))))))))))))))))))))))))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시',
time>='02:00'&time<'03:00', '02시',
time>='03:00'&time<'04:00', '03시',
time>='04:00'&time<'05:00', '04시',
time>='05:00'&time<'06:00', '05시',
time>='06:00'&time<'07:00', '06시',
time>='07:00'&time<'08:00', '07시',
time>='08:00'&time<'09:00', '08시',
time>='09:00'&time<'10:00', '09시',
time>='10:00'&time<'11:00', '10시',
time>='11:00'&time<'12:00', '11시',
time>='12:00'&time<'13:00', '12시',
time>='13:00'&time<'14:00', '13시',
time>='14:00'&time<'15:00', '14시',
time>='15:00'&time<'16:00', '15시',
time>='16:00'&time<'17:00', '16시',
time>='17:00'&time<'18:00', '17시',
time>='18:00'&time<'19:00', '18시',
time>='19:00'&time<'20:00', '19시',
time>='20:00'&time<'21:00', '20시',
time>='21:00'&time<'22:00', '21시',
time>='22:00'&time<'23:00', '22시', '23시'))))))))))))))))))))))))
data2
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시'))
data2 %>%
mutate(everyhour=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시'))
data2 %>%
mutate(time=ifelse(time<'01:00', '00시',
time>='01:00'&time<'02:00', '01시'))
data2 %>%
mutate(everyhour=ifelse(data2$time<'01:00', '00시',
data2$time>='01:00'&data2$time<'02:00', '01시'))
str(data)
data2
data2 %>%
mutate(everyhour=if(data2$time<'01:00'){
}, '00시')
data2
data3<-data2[,-1]
data3
#Lubridate
data2<-data%>%
select(datetime, score) %>%
mutate(date = substr(data$datetime,6, 10)) %>%
mutate(time = substr(data$datetime,12, 13))
data3<-data2%>%
group_by(date) %>%
summarise(average=mean(score))
date_review<-ggplot(data3, aes(x=date, y=average), fill=date) +
labs(x='날짜', y='평균 평점') +
geom_bar(width=0.5, stat='identity') +
ggtitle('날짜별 평균 평점') +
theme(plot.title = element_text(face = "bold", hjust = 0.5,
size = 15, color = "darkblue"))
ggplotly(date_review)
data3<-data2[,-1]
data3
data3 %>%
group_by(time) %>%
summarise(average=round(mean(score),1))
data3 %>%
group_by(time) %>%
summarise(average=round(mean(score),1)) %>%
arrange(time)
data3
perhour<-data3 %>%
group_by(time) %>%
summarise(average=round(mean(score),1)) %>%
arrange(time)
perhour
date_review<-ggplot(data3, aes(x=date, y=average)) +
labs(x='날짜', y='평균 평점') +
geom_bar(width=0.5, stat='identity') +
ggtitle('날짜별 평균 평점') +
theme(plot.title = element_text(face = "bold", hjust = 0.5,
size = 15, color = "darkblue"))
ggplotly(date_review)
#Lubridate
data2<-data%>%
select(datetime, score) %>%
mutate(date = substr(data$datetime,6, 10)) %>%
mutate(time = substr(data$datetime,12, 13))
data3<-data2%>%
group_by(date) %>%
summarise(average=mean(score))
date_review<-ggplot(data3, aes(x=date, y=average)) +
labs(x='날짜', y='평균 평점') +
geom_bar(width=0.5, stat='identity') +
ggtitle('날짜별 평균 평점') +
theme(plot.title = element_text(face = "bold", hjust = 0.5,
size = 15, color = "darkblue"))
ggplotly(date_review)
data3<-data2[,-1]
perhour<-data3 %>%
group_by(time) %>%
summarise(avr=round(mean(score),1)) %>%
arrange(time)
date_review<-ggplot(data3, aes(x=date, y=average)) +
labs(x='날짜', y='평균 평점') +
geom_bar(width=0.5, stat='identity') +
ggtitle('스파이더맨 날짜별 평균 평점') +
theme(plot.title = element_text(face = "bold", hjust = 0.5,
size = 15, color = "darkblue"))
ggplotly(date_review)
data3<-data2%>%
group_by(date) %>%
summarise(average=mean(score))
date_review<-ggplot(data3, aes(x=date, y=average)) +
labs(x='날짜', y='평균 평점') +
geom_bar(width=0.5, stat='identity') +
ggtitle('스파이더맨 날짜별 평균 평점') +
theme(plot.title = element_text(face = "bold", hjust = 0.5,
size = 15, color = "darkblue"))
ggplotly(date_review)
hour_review<-ggplot(perhour, aes(x=time, y=avr))+
labs(x='시간대', y='평균 평점') +
geom_bar(width=0.5, stat='identity') +
ggtitle('스파이더맨 시간대별 평균 평점') +
theme(plot.title = element_text(face = "bold", hjust = 0.5,
size = 15, color = "darkblue"))
ggplotly(hour_review)
