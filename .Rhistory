for (li in lis) {
score <- c(score, html_node(li,'.star_score') %>%
html_text('em') %>% trim())
li %>%
html_node('.score_reple') %>%
html_text('p') %>%
trim() -> comments
idx <- str_locate(comments, "\r")
review <- c(review, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
writer <- c(writer, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
time <- c(time, str_sub(comments, 1, idx[1]-1))
}
total_review <- data.frame(score=score, review=review, writer=writer, time=time)
dfs <- rbind.data.frame(dfs, total_review)
}
library(rvest)
library(stringr)
library(dplyr)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
dfs <- createWorkbook()
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
pages<-c(1:253)
#dfs <- data.frame(score=c(), review=c(), writer=c(), time=c())
for(i in 1:253){
url <- paste0(main_url, pages[i])
html <- read_html(url)
html %>%
html_node('iframe.ifr') %>%
html_attr('src')->url2
ifr_url <- paste0(main_url, url2)
html2 <- read_html(ifr_url)
html2 %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
score <- c(score, html_node(li,'.star_score') %>%
html_text('em') %>% trim())
li %>%
html_node('.score_reple') %>%
html_text('p') %>%
trim() -> comments
idx <- str_locate(comments, "\r")
review <- c(review, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
writer <- c(writer, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
time <- c(time, str_sub(comments, 1, idx[1]-1))
}
total_review <- data.frame(score=score, review=review, writer=writer, time=time)
#dfs <- rbind.data.frame(dfs, total_review)
}
#saveWorkbook(dfs, file="D:/Workspace/R-Project/SpiderMan_review.xlsx")
write.csv(total_review, "SpiderMan_review.csv" , row.names = FALSE)
#dfs <- data.frame(score=c(), review=c(), writer=c(), time=c())
for(i in 1:253){
url <- paste0(main_url, pages[i])
html <- read_html(url)
html %>%
html_node('iframe.ifr') %>%
html_attr('src')->url2
ifr_url <- paste0(main_url, url2)
html2 <- read_html(ifr_url)
html2 %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
# score <- c()
# review <- c()
# writer <- c()
# time <- c()
for (li in lis) {
score <- c(score, html_node(li,'.star_score') %>%
html_text('em') %>% trim())
li %>%
html_node('.score_reple') %>%
html_text('p') %>%
trim() -> comments
idx <- str_locate(comments, "\r")
review <- c(review, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
writer <- c(writer, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
time <- c(time, str_sub(comments, 1, idx[1]-1))
}
total_review <- data.frame(score=score, review=review, writer=writer, time=time)
#dfs <- rbind.data.frame(dfs, total_review)
}
#saveWorkbook(dfs, file="D:/Workspace/R-Project/SpiderMan_review.xlsx")
write.csv(total_review, "SpiderMan_review.csv" , row.names = FALSE)
html<-read_html(main_url)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
tmp<-html%>%
html_node('.score_total') %>%
html_node('.sp') %>%
html_text('em') %>%
trim()
tmp
tmp<-html%>%
#html_node('.score_total') %>%
html_node('.sp') %>%
html_text('em') %>%
trim()
tmp
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
tmp
idx <- str_locate(tmp, "|")
idx
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
tmp
idx <- str_locate(tmp, "|")
pages <- c(pages, str_sub(tmp, 1, 1-idx[1]))
pages
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
idx <- str_locate(tmp, "|")
pages <- c(pages, str_sub(tmp, 1, 1-idx[1]))
pages
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
idx <- str_locate(tmp, "|")
pages <- c(pages, str_sub(tmp, 1, 1-idx[1]))
pages
#SpiderMan Far from home
library(rvest)
library(stringr)
library(dplyr)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
idx <- str_locate(tmp, "|")
pages <- c(pages, str_sub(tmp, 1, 1-idx[1]))
idx
tmp
idx <- str_locate(tmp, "총")
idx
pages <- c(pages, str_sub(tmp, -8, -1))
pages <- str_sub(tmp, -8, -1))
pages <- str_sub(tmp, -8, -1)
pages
pages <- str_sub(tmp, -9, -1)
pages
pages <- str_sub(tmp, -7, -1)
pages
str_locate(tmp, "총")
pages <- str_sub(tmp, -7, 2)
pages
pages <- str_sub(tmp, -7, 1)
pages
pages <- str_sub(tmp, -7, 1)
pages
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
str_locate(tmp, "총")
pages <- str_sub(tmp, -7, 1)
pages
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
str_locate(tmp, "총")
pages <- str_sub(tmp, -7, 1)
pages
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
str_locate(tmp, "총")
pages <- str_sub(tmp, -7, -1)
pages
pages <- str_sub(tmp, -7, -2)
pages
pages <- str_sub(tmp, -6, -2)
pages
str(pages)
pages<-c(1:(pages/10)+1)
pages
pages+1
as.numeric(pages)
as.numeric(pages)
pages
as.integer(pages)
as.integer(pages)
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
str_locate(tmp, "총")
pages <- str_sub(tmp, -6, -2)
as.integer(pages)
pages
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
str_locate(tmp, "총")
pages <- str_sub(tmp, -6, -2)
as.integer(pages)
str_locate(tmp, "총")
pages <- str_sub(tmp, -6, -2)
as.integer(pages)
pages
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
str_locate(tmp, "총")
pages <- str_sub(tmp, -6, -2)
pages
str_locate(tmp, "총")
str_locate(tmp, "|")
str_locate(tmp, "|")
tmp
str_locate(tmp, "총총")
str_locate(tmp, "총")
pages <- str_sub(tmp, 8, -2)
pages
pages <- str_sub(tmp, 9, -2)
pages
as.integer(pages)
pages
as.integer(pages)
pages
total_pages<-c(1:pages)
pages<-as.integer(pages)
pages<-as.numeric(pages)
pages
total_pages<-c(1:pages)
tmp
as.numeric(tmp)
str_locate(tmp, "총")
pages <- str_sub(tmp, 9, -2)
pages
end_page<-c(pages)
end_page
pages<-as.numeric(end_page)
end_page+1
time
as.numeric(pages)
as.numeric(pages)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
tmp
trnaform(pages, chr=as.numeric(chr))
transform(pages, chr=as.numeric(chr))
transform(pages, chr=as.numeric(pages))
#SpiderMan Far from home
library(rvest)
library(stringr)
library(dplyr)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
str_locate(tmp, "총")
pages <- str_sub(tmp, 9, -2)
pages
class(pages)
pages<-as.numeric(pages)
pages
#SpiderMan Far from home
library(rvest)
library(stringr)
library(dplyr)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
str_locate(tmp, "총")
pages <- str_sub(tmp, 9, -2)
pages
total_pages<-c(1:265)
for(total_pages in 1:265){
url <- paste0(main_url, total_pages)
html <- read_html(url)
html %>%
html_node('iframe.ifr') %>%
html_attr('src')->url2
ifr_url <- paste0(main_url, url2)
html2 <- read_html(ifr_url)
html2 %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
# score <- c()
# review <- c()
# writer <- c()
# time <- c()
for (li in lis) {
score <- c(score, html_node(li,'.star_score') %>%
html_text('em') %>% trim())
li %>%
html_node('.score_reple') %>%
html_text('p') %>%
trim() -> comments
idx <- str_locate(comments, "\r")
review <- c(review, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
writer <- c(writer, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
time <- c(time, str_sub(comments, 1, idx[1]-1))
}
total_review <- data.frame(score=score, review=review, writer=writer, time=time)
#dfs <- rbind.data.frame(dfs, total_review)
}
for(total_pages in 1:265){
url <- paste0(main_url, total_pages)
html <- read_html(url)
html %>%
html_node('iframe.ifr') %>%
html_attr('src')->url2
ifr_url <- paste0(main_url, url2)
html2 <- read_html(ifr_url)
html2 %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
score <- c(score, html_node(li,'.star_score') %>%
html_text('em') %>% trim())
li %>%
html_node('.score_reple') %>%
html_text('p') %>%
trim() -> comments
idx <- str_locate(comments, "\r")
review <- c(review, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
writer <- c(writer, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
time <- c(time, str_sub(comments, 1, idx[1]-1))
}
total_review <- data.frame(score=score, review=review, writer=writer, time=time)
#dfs <- rbind.data.frame(dfs, total_review)
}
write.csv(total_review, "SpiderMan_review.csv" , row.names = FALSE)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
str_locate(tmp, "총")
pages <- str_sub(tmp, 9, -2)
pages
# class(pages)
# pages<-as.numeric(pages)
total_review <- data.frame(score=c(), review=c(), writer=c(), time=c())
for(total_pages in 1:265){
url <- paste0(main_url, total_pages)
html <- read_html(url)
html %>%
html_node('iframe.ifr') %>%
html_attr('src')->url2
ifr_url <- paste0(main_url, url2)
html2 <- read_html(ifr_url)
html2 %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
# score <- c()
# review <- c()
# writer <- c()
# time <- c()
for (li in lis) {
score <- c(score, html_node(li,'.star_score') %>%
html_text('em') %>% trim())
li %>%
html_node('.score_reple') %>%
html_text('p') %>%
trim() -> comments
idx <- str_locate(comments, "\r")
review <- c(review, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
writer <- c(writer, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
time <- c(time, str_sub(comments, 1, idx[1]-1))
}
total_review <- data.frame(score=score, review=review, writer=writer, time=time)
#dfs <- rbind.data.frame(dfs, total_review)
}
# class(pages)
# pages<-as.numeric(pages)
dfs <- data.frame(score=c(), review=c(), writer=c(), time=c())
dfs <- rbind.data.frame(dfs, total_review)
#SpiderMan Far from home
library(rvest)
library(stringr)
library(dplyr)
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
str_locate(tmp, "총")
pages <- str_sub(tmp, 9, -2)
pages
# class(pages)
# pages<-as.numeric(pages)
dfs <- data.frame(score=c(), review=c(), writer=c(), time=c())
for(total_pages in 1:265){
url <- paste0(main_url, total_pages)
html <- read_html(url)
html %>%
html_node('iframe.ifr') %>%
html_attr('src')->url2
ifr_url <- paste0(main_url, url2)
html2 <- read_html(ifr_url)
html2 %>%
html_node('div.score_result') %>%
html_nodes('li') -> lis
score <- c()
review <- c()
writer <- c()
time <- c()
for (li in lis) {
score <- c(score, html_node(li,'.star_score') %>%
html_text('em') %>% trim())
li %>%
html_node('.score_reple') %>%
html_text('p') %>%
trim() -> comments
idx <- str_locate(comments, "\r")
review <- c(review, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
writer <- c(writer, str_sub(comments, 1, idx[1]-1))
comments <- trim(str_sub(comments, idx[1], -1))
idx <- str_locate(comments, "\r")
time <- c(time, str_sub(comments, 1, idx[1]-1))
}
total_review <- data.frame(score=score, review=review, writer=writer, time=time)
dfs <- rbind.data.frame(dfs, total_review)
}
write.csv(dfs, "SpiderMan_review.csv" , row.names = FALSE)
pages
gsub(pages, ',')
trim <- function(x) gsub("^\\s+|\\s+$", "", x)
main_url<-'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=173123&type=after&isActualPointWriteExecute=false&isMileageSubscriptionAlready=false&isMileageSubscriptionReject=false&page='
html<-read_html(main_url)
tmp<-html%>%
html_node('.score_total') %>%
html_text('em') %>%
trim()
str_locate(tmp, "총")
pages <- str_sub(tmp, 9, -2)
pages<-gsub(',', '', pages)
end_page<-ceiling(as.numeric(pages)/10)
